document.addEventListener('DOMContentLoaded', function(){ const addBtn=document.getElementById('addItemBtn'); if(!addBtn) return; const pratoSelect=document.getElementById('pratoSelect'); const quantidade=document.getElementById('quantidade'); const tbody=document.querySelector('#itensTable tbody'); const itemsJson=document.getElementById('itemsJson'); let items=[]; addBtn.addEventListener('click',()=>{ const pratoId=pratoSelect.value; const preco=parseFloat(pratoSelect.options[pratoSelect.selectedIndex].dataset.preco||0); const qtd=parseInt(quantidade.value); const nome=pratoSelect.options[pratoSelect.selectedIndex].text; if(!pratoId||isNaN(preco)||isNaN(qtd)||qtd<1){alert('Selecione prato e quantidade vÃ¡lida');return;} const subtotal=preco*qtd; items.push({pratoId:parseInt(pratoId),nome,preco,quantidade:qtd,subtotal}); render();}); function render(){ tbody.innerHTML=''; let total=0; items.forEach((it,idx)=>{ total+=it.subtotal; const tr=document.createElement('tr'); tr.innerHTML=`<td>${it.nome}</td><td>${it.preco.toFixed(2)}</td><td>${it.quantidade}</td><td>${it.subtotal.toFixed(2)}</td><td><button data-idx='${idx}'>Remover</button></td>`; tbody.appendChild(tr);}); itemsJson.value=JSON.stringify(items); } tbody.addEventListener('click',e=>{ if(e.target.tagName==='BUTTON'){ items.splice(parseInt(e.target.dataset.idx),1); render(); }}); });
